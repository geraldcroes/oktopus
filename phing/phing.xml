<?xml version="1.0" encoding="UTF-8"?>

<project name="Oktopus" default="doc">
    <!-- ============================================  -->
    <!-- Target: preparebuild                          -->
    <!-- ============================================  -->
    <target name="preparebuild">
        <mkdir dir="../build" />
    </target>

    <!-- ============================================  -->
    <!-- Target: Test                                  -->
    <!-- ============================================  -->
    <target name="test">
        <echo msg="Launching tests" />
        <exec command="phpunit" outputProperty="phpunitResult" />
        <echo msg="${phpunitResult}" />
    </target>

    <!-- ============================================  -->
    <!-- Target: Doc                               -->
    <!-- ============================================  -->
    <target name="doc">
        <docblox title="API Documentation" destdir="../Documentation">
            <fileset dir="../Oktopus">
                <include name="**/*.php" />
            </fileset>
        </docblox>
    </target>

    <!-- ============================================  -->
    <!-- Target: Phar                               -->
    <!-- ============================================  -->
    <target name="phar" depends="preparebuild">
        <pharpackage
          destfile="../build/oktopus.phar"
          basedir="../"
          stub="stub.php"
          >
          <fileset dir="../Oktopus">
            <include name="**/**" />
          </fileset>
          <metadata>
            <element name="version" value="0.1"/>
            <element name="authors">
              <element name="Gérald Croës">
                <element name="e-mail" value="gerald@croes.org" />
              </element>
            </element>
          </metadata>
        </pharpackage>
    </target>
</project>
